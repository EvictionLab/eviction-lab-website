{{/**

  Shortcode for rendering basic bar graphs

  **Must include the following frontmatter in the `.md` file to use**:

  ```
  scripts:
    - bar-chart
  ```
  
  See: _chart-demo.md for usage

  Props:
    - id: unique identifier for this bar chart instance
    - title: title for the chart
    - csv: url to CSV data File
    - x: name of column in CSV to use for x values
    - xTickFormat: formatting for x values in the tooltip
    - y: name of column in CSV to use for y values
    - yTicks: number of y ticks to display
    - yMin: y axis minimum value
    - yMax: y axis maximum value
    - yFormat: formatting for y axis values
    - yTickFormat: formatting for y values in the tooltip
    - timeUnit: by default treated as week, month will set tooltip formatting and
    make room on axis for last bar (whose data may be for the 1st of the month)
    - margin: string with margin values to make space for axis labels ("{top} {right} {bottom} {left}", default: "8 8 104 40")
    - centerLabels: don't rotate and shift tick labels (the default)
*/}}

{{ $title := .Get "title" }}

<div
  class="chart chart--bar chart--{{ .Get `id` }}"
>
  {{ if $title }}
  <h3 class="chart__title">{{ $title }}</h3>
  {{ end }}
  <div id="{{ .Get `id` }}" class="chart__body">
    <svg></svg>
  </div>

  <script>

    window.addEventListener('load', function() {
      var id = {{ .Get "id" }}
      var rootEl = document.getElementById(id);
      var csv = {{ .Get "data" }}
      var x = {{ .Get "x" }}
      var y = {{ .Get "y" }}
      var barClass = {{ .Get "barClass" }}
      var yTicks = {{ .Get "yTicks" }}
      var margin = {{ .Get "margin" }}
      var xTooltipFormat = {{ .Get "xTooltipFormat" }}
      var yTooltipFormat = {{ .Get "yTooltipFormat" }}
      var yFormat = {{ .Get "yFormat" }}
      var yMin = {{ .Get "yMin" }}
      var yMax = {{ .Get "yMax" }}
      var axis = {{ .Get "axis" }}
      var timeUnit = {{ .Get "timeUnit" }}
      var mark = {{ .Get "mark" }}
      var xLabel = {{ .Get "xLabel" }}
      var yLabel = {{ .Get "yLabel" }}
      var centerLabels = {{ .Get "centerLabels" }}
      
      // Init chart on page load.
      Elab.BarChart.init(rootEl, { xLabel: xLabel, yLabel: yLabel, barClass: barClass, mark: mark, axis: axis, id: id, data: csv, x: x, y: y, yMin: yMin, yMax: yMax, yTicks: yTicks, yFormat: yFormat, yTooltipFormat: yTooltipFormat, xTooltipFormat: xTooltipFormat, margin: margin, timeUnit: timeUnit, centerLabels: centerLabels })
    });
  </script>
</div>
